<div class="column is-2">
  <div class="card">
    <div class="card-image">
      <figure class="image is-2by3"
              data-controller="poster"
              data-action="mouseenter->poster#show mouseleave->poster#hide">
        <%= image_tag movie.poster_or_default, height: "200", width: "300", class: "poster" %>

        <% if current_user.movies.include?(movie) %>
          <%= button_to "Remove from watchlist",
            watchlist_path(current_user.watchlists.find { |w| w.movie == movie }.id),
            method: :delete,
            params: { redirect_to: redirect_path },
            remote: true,
            class: "button is-danger is-small overlay-button"  %>
        <% else %>
          <%= button_to "Add to watchlist",
            watchlists_path,
            method: :post,
            params: { "watchlist[movie_id]" => movie.id,
                      "watchlist[user_id]" => current_user.id },
          remote: true,
          class: "button is-link is-small overlay-button"  %>
        <% end %>

        <div
          class="overlay-box has-opacity-75 is-flex is-hidden"
          style="background-color:white;justify-content:center;align-items:center"
          data-target="poster.overlay">
          <div class="is-centered has-text-centered has-text-weight-semibold">
            <p class="is-size-6"><%= movie.title %></p>
            <p class="is-size-7"><%= movie.year %></p>
          </div>
        </div>

      </figure>

    </div>

    <%# if current_user.movies.include?(movie) %>
    <%#= button_to "Submit to movie night",
    watchlists_path,
    method: :post,
    form: { data: { action: "ajax:success->form#dataAdded" } },
    params: { "watchlist[movie_id]" => movie.id,
              "watchlist[user_id]" => current_user.id },
    remote: true,
    class: "button is-small"  %>
  <%# end %>


  </div>

</div>
